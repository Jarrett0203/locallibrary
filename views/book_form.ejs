<!DOCTYPE html>
<html lang="en">

<head>
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css" />
</head>

<% 
  let bookTitle = ''; 
  let family_name = '';
  let birth_date = '';
  let death_date = '';
  if (typeof book != 'undefined') {
    bookTitle = book.title;
  }
%>

<body>
  <h1><%= title %></h1>
  <form action="" method="post">

    <div class="form-group">
      <label for="title">Title:</label>
      <input type="text" id="title" class="form-control" placeholder="Name of book" required="true" name="title" value=<%= bookTitle %>>
    </div>

    <div class="form-group">
      <label for="author">Author:</label>
      <select type="select" id="author" class="form-control" placeholder="Select author" required="true" name="author">
        <%
        authors.sort(function(a,b) {
          let textA = a.family_name.toUpperCase();
          let textB = b.family_name.toUpperCase();
          return (textA < textB) ? -1 : (textA > textB) ? 1 : 0;
        })%>
        <% for (let author of authors) { %>
        <% if (typeof book != "undefined") { %>
        <option value="<%=author._id%>" selected="<%=author._id.toString()===book.author._id.toString() ? 'selected' : false %>">
          <%= author.name %>
        </option>
        <% } else { %>
        <option value="<%= author._id %>"><%= author.name %></option>
        <% } 
        } %>
      </select>
    </div>

    <div class="form-group">
      <label for="summary">Summary:</label>
      <input type="text" id="summary" class="form-control" placeholder="Summary" required="true" name="summary">
      <%= typeof book === "undefined" ? '' : book.summary %>
      </input>
    </div>

    <div class="form-group">
      <label for="isbn">ISBN:</label>
      <input type="text" id="isbn" class="form-control" placeholder="ISBN13" required="true" name="isbn">
      <%= typeof book === "undefined" ? '' : book.isbn %>
      </input>
    </div>

    <div class="form-group">
      <label>Genre:</label>
      <div>
        <% for(let genre of genres) { %>
        <div style="display:inline; padding-right: 10px;">
          <input type="checkbox" class="checkbox-input" name="genre" id="<%=genre._id%>" value="<%= genre._id %>">
          <label for="<%=genre._id%>"><%= genre.name %> </label>
        </div>
        <% } %>
      </div>
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>

  <% if (typeof errors != 'undefined') { %>
  <ul>
    <% for(let error of errors) { %>
    <li><%= error.msg %> </li>
    <% } %>
  </ul>
  <% } %>
</body>

</html>